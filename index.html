<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0">
<title>Rubik's Cube</title>

<link rel="stylesheet" href="style.css">
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/three.js/95/three.min.js"></script>

<style>
/* DO NOT TOUCH ORIGINAL UI â€” ONLY ENSURE GAME LAYER WORKS */
.ui__game {
  position:absolute;
  inset:0;
  pointer-events:auto;
}
.ui__game canvas {
  display:block;
}
</style>
</head>

<body>

<div class="ui">

  <div class="ui__background"></div>
  <div class="ui__game"></div>

  <div class="ui__texts">
    <h1 class="text text--title">
      <span>THE</span>
      <span>CUBE</span>
    </h1>
    <div class="text text--note">Double tap to start</div>
    <div class="text text--timer">0:00</div>
    <div class="text text--complete"><span>Complete!</span></div>
    <div class="text text--best-time">
      <span>Best Time!</span>
    </div>
  </div>

  <div class="ui__prefs">
    <range name="size" title="Cube Size" list="2,3,4,5"></range>
    <range name="flip" title="Flip Type" list="Swift,Smooth,Bounce"></range>
    <range name="scramble" title="Scramble Length" list="20,25,30"></range>
    <range name="fov" title="Camera Angle" list="Ortographic,Perspective"></range>
    <range name="theme" title="Color Scheme" list="Cube,Erno,Dust,Camo,Rain"></range>
  </div>

  <div class="ui__theme">
    <range name="hue" title="Hue" color></range>
    <range name="saturation" title="Saturation" color></range>
    <range name="lightness" title="Lightness" color></range>
  </div>

  <div class="ui__stats"></div>

  <div class="ui__buttons">
    <button class="btn btn--bl btn--stats"></button>
    <button class="btn btn--br btn--prefs"></button>
    <button class="btn btn--bl btn--back"></button>
    <button class="btn btn--br btn--theme"></button>
    <button class="btn btn--br btn--reset"></button>
  </div>

</div>

<script>
/* ================== THREE (CUBE ONLY) ================== */

let scene, camera, renderer, cubeGroup;

initCube();
animate();

function initCube(){
  const container = document.querySelector('.ui__game');

  scene = new THREE.Scene();

  camera = new THREE.PerspectiveCamera(
    45,
    container.clientWidth / container.clientHeight,
    0.1,
    100
  );
  camera.position.set(6,6,6);
  camera.lookAt(0,0,0);

  renderer = new THREE.WebGLRenderer({
    antialias:true,
    alpha:true   // keeps UI clean
  });

  renderer.setSize(container.clientWidth, container.clientHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  container.appendChild(renderer.domElement);

  scene.add(new THREE.AmbientLight(0xffffff,0.8));
  const light = new THREE.DirectionalLight(0xffffff,0.6);
  light.position.set(5,10,7);
  scene.add(light);

  cubeGroup = buildCube();
  scene.add(cubeGroup);

  window.addEventListener('resize', onResize);
}

function onResize(){
  const c = document.querySelector('.ui__game');
  camera.aspect = c.clientWidth / c.clientHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(c.clientWidth, c.clientHeight);
}

/* ================== RUBIK'S CUBE ================== */

function buildCube(){
  const g = new THREE.Group();
  const colors = [
    0xff0000,  // R
    0xff8000,  // L
    0xffffff,  // U
    0xffff00,  // D
    0x00ff00,  // F
    0x0000ff   // B
  ];

  for(let x=-1;x<=1;x++)
  for(let y=-1;y<=1;y++)
  for(let z=-1;z<=1;z++){
    const mats = [
      new THREE.MeshLambertMaterial({color:x=== 1?colors[0]:0x111111}),
      new THREE.MeshLambertMaterial({color:x===-1?colors[1]:0x111111}),
      new THREE.MeshLambertMaterial({color:y=== 1?colors[2]:0x111111}),
      new THREE.MeshLambertMaterial({color:y===-1?colors[3]:0x111111}),
      new THREE.MeshLambertMaterial({color:z=== 1?colors[4]:0x111111}),
      new THREE.MeshLambertMaterial({color:z===-1?colors[5]:0x111111}),
    ];
    const m = new THREE.Mesh(
      new THREE.BoxGeometry(0.95,0.95,0.95),
      mats
    );
    m.position.set(x,y,z);
    g.add(m);
  }
  return g;
}

/* ================== LOOP ================== */

function animate(){
  requestAnimationFrame(animate);
  cubeGroup.rotation.y += 0.0015;
  renderer.render(scene,camera);
}
</script>

</body>
</html>
